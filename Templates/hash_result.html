<!-- templates/hash_result.html -->
{% extends "base.html" %}

{% block content %}
<h2>Hash Lookup Result</h2>
<table class="table table-bordered">
    <tr>
        <th>File Hash</th>
        <td>{{ result.file_hash }}</td>
    </tr>
    <tr>
        <th>Reputation</th>
        <td>{{ result.reputation }}</td>
    </tr>
    <tr>
        <th>Community Reputation</th>
        <td>{{ result.community_reputation }}</td>
    </tr>
    <tr>
        <th>Malicious Detections</th>
        <td>{{ result.malicious_count }} out of {{ result.total_engines }} engines</td>
    </tr>
    {% if result.file_type %}
    <tr>
        <th>File Type</th>
        <td>{{ result.file_type }}</td>
    </tr>
    {% endif %}
    {% if result.file_size %}
    <tr>
        <th>File Size</th>
        <td>{{ result.file_size }} bytes</td>
    </tr>
    {% endif %}
    {% if result.file_signer %}
    <tr>
        <th>Signer</th>
        <td>{{ result.file_signer }}</td>
    </tr>
    {% endif %}
    {% if result.file_names %}
    <tr>
        <th>File Names</th>
        <td>{{ result.file_names | join(', ') }}</td>
    </tr>
    {% endif %}
</table>

<!-- Top 5 Community Comments -->
{% if result.comments %}
    <h3 class="mt-5">Top 5 Community Comments</h3>
    <div class="comments-section">
        {% for comment in result.comments %}
            <div class="comment mb-3">
                <p><strong>{{ comment.user }}</strong> <em>({{ comment.date }})</em></p>
                <p>{{ comment.comment | e }}</p>
            </div>
        {% endfor %}
    </div>
{% else %}
    <h3 class="mt-5">No Community Comments Available</h3>
{% endif %}
{% endblock %}
